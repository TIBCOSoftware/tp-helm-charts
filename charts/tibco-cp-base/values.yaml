#
# Copyright Â© 2023 - 2025. Cloud Software Group, Inc.
# This file is subject to the license terms contained
# in the license file that is distributed with this file.
#
# global values used by the chart. These values gets propagated to all sub-charts.
global:
  tibco:
    is_replica_region: false
    finops: "disable"
    serviceAccount: ""
    # Flag to enable or disable database jobs (upgrade and cleanup)
    # Set to false to disable DB script execution if you want to run scripts manually outside of the chart
    # Default value is true
    manageDbSchema: true
    # k8s rbac required by the service account
    rbac:
      # create the rbac for base resources.
      # set to true to create rbac resources for the service account (cluster role and binding), set to false if the service account already have the rbacs
      infra: true
    containerRegistry:
      url: ""
      username: ""
      password: ""
      repository: ""  # repository
      certificateSecret: ""  # secret name containing the custom certificates
    # Flag to enable or disable creating default network policies for a namespace
    # Default value is false. Possible values are true, false
    createNetworkPolicy: false
    networkPolicy:
      # Create deprecated network policies
      createDeprecatedPolicies: true
      # Enable or disable the creation of cluster-wide network policies
      createClusterScopePolicies: true
      # Enable or disable the creation of internet-facing network policies
      createInternetScopePolicies: true
      # Network policies for access to the database, if no values are provided, the database policy will not be created
      database:
        CIDR: ""
        port: ""
      # Network policies for access to the log server, if no values are provided, the log server policy will not be created
      logServer:
        CIDR: ""
        port: ""
      # Network policies for access to the container registry, if no values are provided, the container registry policy will not be created
      containerRegistry:
        CIDR: ""
        port: ""
      # Network policies for access to the email server, if no values are provided, the email server policy will not be created
      emailServer:
        CIDR: ""
        port: ""
      # Network policies for access to the NLB, if no values are provided, the hybrid connectivity policy will not be created
      hybridConnectivity:
      # - ports:
      #   - port: 443
      #     protocol: TCP
      #   from:
      #     - ipBlock:
      #         cidr: 0.0.0.0/0
      # Network policies for access to the proxy, if no values are provided, the proxy policy will not be created
      proxy:
        CIDR: ""
        port: ""
      # Network policies for access to the Kubernetes API server, if no values are provided, the Kubernetes API server policy will not be created
      kubeApiServer:
        CIDR: ""
        port: ""
      # Network policies for access kube-dns, if no values are provided, the kube-dns policy will be created for a vanilla k8s cluster
      kubeDns:
        egress:
        - to:
          - namespaceSelector: {}
            podSelector:
              matchLabels:
                k8s-app: kube-dns
          ports:
          - protocol: UDP
            port: 53
          - protocol: TCP
            port: 53
    # control plane instance Id. Ex: prod, stag, p01, s01. This is to identify multiple cp installation in same cluster.
    # lowercase alphanumeric string of max 5 chars
    controlPlaneInstanceId: ""
    useSingleNamespace: true
    enableResourceConstraints: true
    self_hosted_deployment: true
    proxy:
      httpProxy: ""
      httpsProxy: ""
      noProxy: ""
    logging:
      # The fluentbit configuration section.
      # It specifies that the fluentbit should not run as a non-root user and the user ID should be 0 (root).
      # Privilege escalation is not allowed for security reasons.
      # Additionally, it drops all capabilities, which is a common security practice to minimize potential risks.
      # GitHub issue: https://github.com/fluent/fluent-bit/issues/872#issuecomment-827763207, https://github.com/kyma-project/kyma/pull/11657/files
      fluentbit:
        enabled: true
        image:
          name: "common-fluentbit"
          registry: ""
          repo: ""
          tag: 4.1.0
          pullPolicy: IfNotPresent
        resources:
          requests:
            cpu: 50m
            memory: 100Mi
          limits:
            cpu: 100m
            memory: 150Mi
      repository: "tibco-platform-docker-prod"  # repository
  external:
    db_host: ""
    db_master_writer_host: ""
    db_local_reader_host: ""
    db_name: ""
    db_port: ""
    db_username: ""
    db_password: ""
    db_secret_name: "provider-cp-database-credentials"
    environment: "production"
    db_ssl_mode: "disable"
    db_ssl_root_cert: ""
    fromAndReplyToEmailAddress: ""
    cronJobReportsEmailAlias: ""
    platformEmailNotificationCcAddresses: ""
    cpEncryptionSecretName: "cporch-encryption-secret"
    cpEncryptionSecretKey: "CP_ENCRYPTION_SECRET"
    emailServerType: ""
    emailServer:
      ses:
        arn: "arn:aws:ses:us-east1:123456789012:identity/user@example.com"
      smtp:
        server: ""
        port: "25"
        username: ""
        password: ""
      sendgrid:
        apiKey: ""
    admin:
      email: ""
      firstname: ""
      lastname: ""
      customerID: ""
    dnsDomain: ""
    dnsTunnelDomain: ""
    clusterInfo:
      nodeCIDR: ""
      serviceCIDR: "172.20.0.0/16"
      podCIDR: ""
    adminInitialPassword: ""

    auditserver:
      index: "audittrail"
#     endpoint: ""
#     username: ""
#     password: ""
    storage:
      pvcName: "control-plane-pvc"
      resources:
        requests:
          storage: 2Gi
      # 1. to create/use volumeName, uncomment storageClassName and set matching value as volume
      # 2. to use default storageClass, keep storageClassName key commented
      # 3. to use pre-configured storageClass, uncomment storageClassName and pass the value
      # 4. to use existing PVC, uncomment pvcName and set the name of the PVC, keep volumeName & storageClassName commented
      # 5. to create/use volumeName with custom name, uncomment pvcName and set the desired name, uncomment storageClassName and set matching value as volume
      # volumeName: "123"
      # storageClassName: "gp2"

# Default values for tp-cp-cli.
tp-cp-cli:
  enabled: true

# Default values for tp-cp-prometheus.
tp-cp-prometheus:
  enabled: true

tp-cp-o11y:
  enabled: true
  # Resource values for production-like setup
  # requests: Minimum amount of resources required for the application to run.
  # limits: Maximum amount of resources the application can use.
  resources:
    requests:
      cpu: 200m  # Minimum CPU required
      memory: 256Mi  # Minimum memory required
    limits:
      cpu: 500m  # Maximum CPU allowed
      memory: 1024Mi  # Maximum memory allowed

tp-cp-configuration:
  # Resource values for production-like setup
  # requests: Minimum amount of resources required for the application to run.
  # limits: Maximum amount of resources the application can use.
  resources:
    requests:
      cpu: 50m  # Minimum CPU required
      memory: 30Mi  # Minimum memory required
    limits:
      cpu: 100m  # Maximum CPU allowed
      memory: 60Mi  # Maximum memory allowed

# Default values for tp-cp-infra.
tp-cp-infra:
  enabled: true
  dpMetadata:
    dpCoreInfrastructureChartVersion: "1.14.2"
    dpCoreInfrastructureAppVersion: "1.14.0"
    dpConfigureNamespaceChartVersion: "1.14.1"
    dpConfigureNamespaceAppVersion: "1.14.0"
  # Resource values for production-like setup
  # requests: Minimum amount of resources required for the application to run.
  # limits: Maximum amount of resources the application can use.
  resources:
    infra-compute-services:
      requests:
        cpu: 200m  # Minimum CPU required
        memory: 256Mi  # Minimum memory required
      limits:
        cpu: 500m  # Maximum CPU allowed
        memory: 1024Mi  # Maximum memory allowed

tp-cp-auditsafe:
  enabled: true
  # Resource values for production-like setup
  # requests: Minimum amount of resources required for the application to run.
  # limits: Maximum amount of resources the application can use.
  resources:
    requests:
      cpu: 200m  # Minimum CPU required
      memory: 256Mi  # Minimum memory required
    limits:
      cpu: 500m  # Maximum CPU allowed
      memory: 1024Mi  # Maximum memory allowed

hybrid-proxy:
  # switch to false to disable hybrid-proxy
  enabled: true
  # HPO replica count
  # replicaCount: "1"  # Commented out - HPA manages replicas dynamically
  # Resource values for production-like setup
  # requests: Minimum amount of resources required for the application to run.
  # limits: Maximum amount of resources the application can use.
  resources:
    requests:
      cpu: 200m  # Minimum CPU required
      memory: 256Mi  # Minimum memory required
    limits:
      cpu: 500m  # Maximum CPU allowed
      memory: 1024Mi  # Maximum memory allowed

router-operator:
  # switch to false to disable router-operator
  enabled: true
  # SecretNames for environment variables TSC_SESSION_KEY and DOMAIN_SESSION_KEY.
  # These secrets are used to store session keys securely.
  # The secrets should be created in the same namespace as the tibco-cp-base.
  # Both keys can be configured in the same secret or different secrets.
  tscSessionKey:
    secretName: session-keys  # default secret name
    key: TSC_SESSION_KEY
  domainSessionKey:
    secretName: session-keys  # default secret name
    key: DOMAIN_SESSION_KEY
  # Resource values for production-like setup
  # requests: Minimum amount of resources required for the application to run.
  # limits: Maximum amount of resources the application can use.
  resources:
    requests:
      cpu: 200m  # Minimum CPU required
      memory: 256Mi  # Minimum memory required
    limits:
      cpu: 500m  # Maximum CPU allowed
      memory: 1024Mi  # Maximum memory allowed

resource-set-operator:
  # switch to false to disable resource-set-operator
  enabled: true
  # Resource values for production-like setup
  # requests: Minimum amount of resources required for the application to run.
  # limits: Maximum amount of resources the application can use.
  resources:
    requests:
      cpu: 200m  # Minimum CPU required
      memory: 256Mi  # Minimum memory required
    limits:
      cpu: 500m  # Maximum CPU allowed
      memory: 1024Mi  # Maximum memory allowed

otel-collector:
  # switch to true to enable otel-collector
  enabled: false
  # Resource values for production-like setup
  # requests: Minimum amount of resources required for the application to run.
  # limits: Maximum amount of resources the application can use.
  resources:
    requests:
      cpu: 200m  # Minimum CPU required
      memory: 256Mi  # Minimum memory required
    limits:
      cpu: 500m  # Maximum CPU allowed
      memory: 1024Mi  # Maximum memory allowed

tp-cp-integration-common:
  enabled: true
