#
# Copyright Â© 2023 - 2024. Cloud Software Group, Inc.
# This file is subject to the license terms contained
# in the license file that is distributed with this file.
#


{{ if .Values.global.tibco.containerRegistry.username }}
{{ if .Values.global.tibco.containerRegistry.password }}

apiVersion: v1
kind: Secret
metadata:
  name: {{ include "tibco-cp-base.container-registry.secret" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "tibco-cp-base.labels" . | nindent 4 }}
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: {{ template "tibco-cp-base.imageCredential" . }}

{{- end }}
{{- end }}

---
{{- if eq .Values.global.tibco.is_replica_region false }}
{{- if .Values.global.tibco.manageDbSchema }}
{{- if and (and .Values.global.external.db_password .Values.global.external.db_username ) .Values.global.external.db_secret_name }}
apiVersion: v1
kind: Secret
metadata:
  labels:
    app.kubernetes.io/managed-by: Helm
  name: {{ .Values.global.external.db_secret_name }}
  namespace: {{ include "tp-control-plane.consts.namespace" . }}
type: Opaque
data:
  PASSWORD: {{ .Values.global.external.db_password | b64enc }}
  USERNAME: {{ .Values.global.external.db_username | b64enc }}
{{- end }}
{{- end }}
{{- end }}