#
# Copyright (c) 2023-2025. Cloud Software Group, Inc.
# This file is subject to the license terms contained
# in the license file that is distributed with this file.
#
top: platform/ems
# latest is first in versions.json
files:
  platform/ems/versions.json: |
    [
        {
            "capabilityVersion": "1.10.0",
            "minCPVersion": "1.9.0",
            "maxCPVersion": "",
            "minVersionRequiredForUpgrade": "1.7.0",
            "minDPVersion": {
                "dp-core-infrastructure": "1.9.0",
                "dp-configure-namespace": "1.9.0"
            },
            "releaseNotes": "#cshid=migration_and_compatibility",
            "releaseDate": "2025/8/30"
        },
        {
            "capabilityVersion": "1.9.0",
            "minCPVersion": "1.6.0",
            "maxCPVersion": "",
            "minVersionRequiredForUpgrade": "1.7.0",
            "minDPVersion": {
                "dp-core-infrastructure": "1.7.0",
                "dp-configure-namespace": "1.7.0"
            },
            "releaseNotes": "#cshid=migration_and_compatibility",
            "releaseDate": "2025/7/30"
        },
        {
            "capabilityVersion": "1.7.0",
            "minCPVersion": "1.6.0",
            "maxCPVersion": "",
            "minVersionRequiredForUpgrade": "1.6.0",
            "minDPVersion": {
                "dp-core-infrastructure": "1.7.0",
                "dp-configure-namespace": "1.7.0"
            },
            "releaseNotes": "#cshid=migration_and_compatibility",
            "releaseDate": "2025/5/30"
        }
    ]
  platform/ems/1.10.0/recipe.yaml: |
    recipe:
        helmCharts:
        -   flags:
                createNamespace: false
                install: true
            name: msg-ems-tp
            namespace: ${NAMESPACE}
            releaseName: ${EMS_NAME}
            repository:
                chartMuseum:
                    host: "${HELM_REPO}"
            values:
            -   content: |
                  emsVersion: "10.4.0-85"
                  ems:
                    name: ${EMS_NAME}
                    use: ${EMS_USE}
                    sizing: ${EMS_SIZE}
            version: "1.10.7"
  platform/ems/1.10.0/package.json: |
    {
        "package": {
            "allowMultipleInstances": true,
            "capabilityResourceDependencies": [
                {
                    "required": true,
                    "description": "Select a resource for the storage-class of EMS message data",
                    "resourceId": "STORAGE",
                    "resourceType": "PLATFORM",
                    "type": "Message Storage"
                },
                {
                    "description": "Select a resource for the storage-class of EMS logs store",
                    "required": false,
                    "resourceId": "STORAGE",
                    "resourceType": "PLATFORM",
                    "type": "Log Storage"
                }
            ],
    	    "dependsOn": [
    	      {
    		"version": [
    		  1,
    		  9,
    		  0
    		],
    		"capabilityId": "MSGCORE",
    		"capabilityType": "INFRA"
    	      }
    	    ],
            "provisioningRoles": [
                "DEV_OPS"
            ],
            "services": [
                {
                    "description": "EMS Service",
                    "name": "ems"
                }
            ]
        }
    }
  platform/ems/1.9.0/recipe.yaml: |
    recipe:
        helmCharts:
        -   flags:
                createNamespace: false
                install: true
            name: msg-ems-tp
            namespace: ${NAMESPACE}
            releaseName: ${EMS_NAME}
            repository:
                chartMuseum:
                    host: "${HELM_REPO}"
            values:
            -   content: |
                  emsVersion: "10.4.0-82"
                  ems:
                    name: ${EMS_NAME}
                    use: ${EMS_USE}
                    sizing: ${EMS_SIZE}
            version: "1.9.28"
  platform/ems/1.9.0/package.json: |
    {
        "package": {
            "allowMultipleInstances": true,
            "capabilityResourceDependencies": [
                {
                    "required": true,
                    "description": "Select a resource for the storage-class of EMS message data",
                    "resourceId": "STORAGE",
                    "resourceType": "PLATFORM",
                    "type": "Message Storage"
                },
                {
                    "description": "Select a resource for the storage-class of EMS logs store",
                    "required": false,
                    "resourceId": "STORAGE",
                    "resourceType": "PLATFORM",
                    "type": "Log Storage"
                }
            ],
    	    "dependsOn": [
    	      {
    		"version": [
    		  1,
    		  9,
    		  0
    		],
    		"capabilityId": "MSGCORE",
    		"capabilityType": "INFRA"
    	      }
    	    ],
            "provisioningRoles": [
                "DEV_OPS"
            ],
            "services": [
                {
                    "description": "EMS Service",
                    "name": "ems"
                }
            ]
        }
    }
  platform/ems/1.7.0/recipe.yaml: |
    recipe:
        helmCharts:
        -   flags:
                createNamespace: false
                install: true
            name: msg-ems-tp
            namespace: ${NAMESPACE}
            releaseName: ${EMS_NAME}
            repository:
                chartMuseum:
                    host: "${HELM_REPO}"
            values:
            -   content: |
                  emsVersion: "10.4.0"
                  ems:
                    name: ${EMS_NAME}
                    use: ${EMS_USE}
                    sizing: ${EMS_SIZE}
            version: "1.7.19"
  platform/ems/1.7.0/package.json: |
    {
        "package": {
            "allowMultipleInstances": true,
            "capabilityResourceDependencies": [
                {
                    "required": true,
                    "description": "Select a resource for the storage-class of EMS message data",
                    "resourceId": "STORAGE",
                    "resourceType": "PLATFORM",
                    "type": "Message Storage"
                },
                {
                    "description": "Select a resource for the storage-class of EMS logs store",
                    "required": false,
                    "resourceId": "STORAGE",
                    "resourceType": "PLATFORM",
                    "type": "Log Storage"
                }
            ],
            "dependsOn": [],
            "provisioningRoles": [
                "DEV_OPS"
            ],
            "services": [
                {
                    "description": "EMS Service",
                    "name": "ems"
                }
            ]
        }
    }
