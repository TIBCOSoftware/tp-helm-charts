# Copyright Â© 2025. Cloud Software Group, Inc.
# This file is subject to the license terms contained
# in the license file that is distributed with this file.

{{- if .Values.bwmcpserver.enabled }}
apiVersion: cloud.tibco.com/v1
kind: TibcoRoute
metadata:
  name: {{ include "tp-cp-bw-mcpserver.consts.appName" . }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "bw-webserver.shared.labels.standard" . | nindent 4 }}
spec:
  serviceName: {{ include "tp-cp-bw-mcpserver.consts.appName" . }}
  env:
  - name: TSC_DNS_DOMAIN
    valueFrom:
      configMapKeyRef:
        name: {{ include "tp-control-plane-dnsdomain-configmap" . }}
        key: TSC_DNS_DOMAIN
  endpoints:
  - path: /bw/mcp
    internalPath: /mcp
    port: 8085
    protocol: http
    proxies:
    - listener: virtual
      config: secure
      fqdn: "${TSC_DNS_DOMAIN}"
{{- end }}
