{{- if .Values.o11ymcpserver.enabled }}
apiVersion: cloud.tibco.com/v1
kind: TibcoRoute
metadata:
  name: {{ include "tp-cp-o11y-mcp-server.consts.appName" . }}
  labels:
    {{- include "tp-cp-o11y.shared.labels.standard" . | nindent 4 }}
spec:
  serviceName: {{ include "tp-cp-o11y-mcp-server.consts.appName" . }}
  env:
    - name: TSC_DNS_DOMAIN
      valueFrom:
        configMapKeyRef:
          name: {{ include "tp-cp-o11y-dnsdomain-configmap" . }}
          key: TSC_DNS_DOMAIN
  endpoints:
    - path: /o11y/mcp
      internalPath: /mcp/
      port: 8000
      protocol: http
      proxies:
        - listener: virtual
          config: secure
          fqdn: "${TSC_DNS_DOMAIN}"
{{- end }}